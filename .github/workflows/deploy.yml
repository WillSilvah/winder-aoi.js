name: Deploy Winder

on:
  push:
    branches:
      - main
      - canary
      - controller

jobs:
  deploy:
    runs-on: self-hosted
    steps:
      - name: Checkout do c√≥digo
        uses: actions/checkout@v4

      # DEPLOY PARA WINDER STABLE
      - name: Deploy Main
        if: github.ref == 'refs/heads/main'
        run: |
          cd /home/frufru/services/winder
          git pull origin main
          npm install
          pm2 restart winder-bot

      # DEPLOY PARA O WINDER CANARY
      - name: Deploy Canary
        if: github.ref == 'refs/heads/canary'
        run: |
          cd /home/frufru/services/winder-canary
          git pull origin canary
          npm install
          pm2 restart winder-canary

      # DEPLOY PARA O WINDER CONTROLLER
      - name: Deploy Controller
        if: github.ref == 'refs/heads/controller'
        run: |
          cd /home/frufru/services/winder-controller
          git pull origin controller
          npm install
          pm2 restart winder-controller
